define("common/ui/select/select",["common/ui/popup_base/popup_base","css!common/ui/select/select.css"],function(a){function b(a){this.option=a;this.$div=a.$div;this.init()}b.prototype={option:null,$div:null,init:function(){this.buildHTML()},buildHTML:function(){var a,b=[],c=[],d;a=["<div>",'   <div class="qiu-select_title" >'+(this.option.title||"&nbsp;")+"</div>",'   <div class="qui-select  '+(screen.height<=480?"qui-select-min":"")+'  clearfix" >','<div class="current"></div>','<div class="top"></div>','<div class="end"></div>',"{{__list__}}","   </div>",'   <div class="qiu-select_okBtn">确定</div>','   <div class="qiu-select_canCelBtn">取消</div>',"</div>"].join("");d=1/this.option.data.length*100+"%";$.each(this.option.data,function(){c.push('<ul class="list" data-count="'+this.length+'"   style="top: 100px;width:'+d+';" >');$.each(this,function(){c.push('<li data-value="'+this.value+'" '+(this.select?'data-default="true"':"")+" >"+this.text+"</li>")});c.push("</ul>");b.push(c.join(""));c.length=0});a=a.replace("{{__list__}}",b.join(""));this.$div=$(a);b.length=c.length=0;a=b=c=d=null},getHTML:function(){return this.$div[0].outerHTML},bindEvent:function(a){this.$div=a.find(".qui-select");var b=this;this.$div.delegate(".list","touchstart",function(a){b.evt_touchstart(a)});this.$div.delegate(".list","touchmove",function(a){b.evt_touchmove(a)});this.$div.delegate(".list","touchend",function(a){b.evt_touchend(a)});a.find(".qiu-select_okBtn").click(function(a){b.evt_ok(a)});a.find(".qiu-select_canCelBtn").click(function(a){b.evt_cancel(a)});var c,d;this.$div.children(".list").each(function(){c=$(this);d=c.children('li[data-default="true"]');if(d.length){d.addClass("selectItem");c.css("top",100-d.index()*50)}else{c.children("li").eq(0).addClass("selectItem")}});c=d=null},_startPoint:null,_touchList:null,_top:null,_itemCount:null,evt_touchstart:function(a){this._touchList=a.currentTarget;this._itemCount=this._touchList.getAttribute("data-count")|0;if(this._itemCount>1){this._startPoint=a.touches[0].pageY;this._top=this._touchList.style.top;this._top=this._top?parseInt(this._top,10):0}else{a.stopPropagation();a.preventDefault()}},evt_touchmove:function(a){if(this._itemCount<=1){return}var b=a.touches[0].pageY-this._startPoint+this._top;if(b>=(this._itemCount==2?50:0)&&b<=100){this._touchList.style.top=b+"px"}else if(b<0&&(this._itemCount-3)*50>=Math.abs(b)){this._touchList.style.top=b+"px"}b=null},evt_touchend:function(a){if(this._itemCount>1){var b,c,d;b=parseInt(this._touchList.style.top,10);c=Math.abs(b%50);if(c>=25){if(b>=0){d=b+50-Math.abs(c)}else{d=b-50+Math.abs(c)}}else{if(b>=0){d=b-Math.abs(c)}else{d=b+Math.abs(c)}}this._touchList.style.top=d+"px";this.setSelectItemStyle(this._touchList);b=c=d=null}this._startPoint=this._touchList=this._top=this._itemCount=null},getValue:function(){var a=[],b;this.$div.children(".list").each(function(){b=$(this).children(".selectItem");a.push({text:b.text(),value:b.attr("data-value")})});return a},evt_ok:function(b){if(this.option.onSelect){this.option.onSelect(this.getValue())}a.hide()},evt_cancel:function(b){a.hide()},setSelectItemStyle:function(a){var b,c,d=0,e=100;b=$(a);b.find(".selectItem").removeClass("selectItem");c=parseInt(b.css("top"),10);while(e-c!=0){e-=50;d++}b.children("li").eq(d).addClass("selectItem");b=c=d=e=null}};var c={show:function(c){var d=new b(c);a.show({type:1,contentHTML:d.getHTML(),onShow:function(){window.qyerUtil.disableBodyScroll();c.onShow&&c.onShow()},onHide:function(){window.qyerUtil.enableBodyScroll();c.onHide&&c.onHide()}});d.bindEvent($(a.getContent()));d=null},getContent:function(){return a.getContent()}};return c});