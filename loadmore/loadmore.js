define("common/ui/loadmore/loadmore",function(a){function b(a,b){this.$div=a;this.option=b;_pageNum=1;this.init()}b.prototype={$div:null,$loadBtn:null,option:null,init:function(){this.createBtn();this.bindEvt()},createBtn:function(){var a=this.option.ipg?'data-bn-ipg="'+this.option.ipg+'"':"";this.$loadBtn=$('<p class="qui-paginationLoad"><a href="javascript:void(0)" '+a+"><span>"+(this.option.normalText||"加载更多")+"</span></a></p>");this.$div.append(this.$loadBtn)},bindEvt:function(){var a=this;this.$loadBtn.on(qyerUtil.EVENT.CLICK,function(b){if(a._state==0||a._state==2){a.setState(1);if(a.option.onLoadMore){a.option.onLoadMore.call(a.$div[0],++a._pageNumber)}}});if(this.option.autoLoadMore){$(window).on("scroll",qyerUtil.runOneInPeriodOfTime(function(){if($(window).scrollTop()+$(window).height()>=a.$div.find("p.qui-paginationLoad").offset().top){a.$loadBtn.trigger(qyerUtil.EVENT.CLICK)}},500))}},_state:0,setState:function(a){var b=["qui-paginationLoad","loading","error"];this.$loadBtn[0].className=b[0];if(a==0){this.$loadBtn.find("span").html(this.option.normalText||"加载更多")}else if(a==1){this.$loadBtn.find("span").html(this.option.loadingText||"正在加载");this.$loadBtn.addClass(b[1])}if(a==2){this.$loadBtn.find("span").html(this.option.errorText||"加载失败，点击重新加载");this.$loadBtn.addClass(b[2])}this._state=a},pushHTML:function(a){if(this.option.el&&this.$div.find(this.option.el).size()>0){this.$div.find(this.option.el).append(a)}else{$(a).insertBefore(this.$loadBtn)}this.setState(0)},removeBtn:function(){this.$loadBtn.hide()},addBtn:function(){this.$loadBtn.show()},_pageNumber:1,setPageNumber:function(a){this._pageNumber=typeof a==="number"?a:1},pageNumber:function(a){if(typeof a!=="undefined"){this.setPageNumber(a)}return this._pageNumber}};Zepto.extend(Zepto.fn,{qyerLoadMore:function(a,c,d){var e=$.type(a);var f;if(e=="object"||e=="undefined"){$.each(this,function(){f=$(this);if(!this.__loadMore__){this.__loadMore__=new b(f,a)}})}else if(e=="string"){var g=["pushHTML","setState","removeBtn","addBtn","pageNumber"],h=[];if(g.indexOf(a)!=-1){$.each(this,function(){f=$(this);h.push(this.__loadMore__[a](c,d))});switch(a){case"pageNumber":return h;default:return this}}}}})});